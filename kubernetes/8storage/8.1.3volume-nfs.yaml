# 创建namespace
apiVersion: v1
kind: Namespace
metadata:
  name: 8lquan
  labels:
    app: 8lquan-labels

---
#创建挂载nfs挂载盘
apiVersion: v1
kind: Pod
metadata:
        name: volume-nfs
        namespace: 8lquan
spec:
        containers:
        - name: nginx
          image: nginx:1.17.1
          ports:
          - containerPort: 80
          volumeMounts: # 将logs-volume挂载到nginx容器中，对应的目录为 /var/log/nginx
          - name: logs-volume
            mountPath: /var/log/nginx

          - name: resource-nginx-volume
            mountPath: /usr/share/nginx/html

          lifecycle:
            postStart:
              exec:  # 在容器启动的时候执行一个命令，修改掉nginx的默认首页内容
                command:  ["/bin/sh", "-c", "echo postStart... > /usr/share/nginx/html/index.html"]
        
        - name: busybox
          image: busybox:1.30
          command: ["/bin/sh","-c","tail -f /logs/access.log"]  # 初始命令，动态读取指定文件中内容
          volumeMounts: # 将logs-volume挂载到busybox容器中，对应的目录为 /logs
          - name: logs-volume
            mountPath: /logs
        volumes:        #声明volume，name为logs-volume，类型为emptyDir
        - name: logs-volume
          nfs:
            server: 192.168.254.89 # 共享文件路径
            path: /root/lquan/nfs # nfs服务器地址
        - name: resource-nginx-volume
          nfs:
            path:  /root/lquan/nginx  #/usr/share/nginx/
            server: 192.168.254.89


         
